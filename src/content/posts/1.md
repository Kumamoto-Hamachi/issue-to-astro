---
title: "実験的につくってみたよ"
issue_number: 1
created_at: "2026-02-25T09:48:41Z"
labels: []
---

# Ubuntu 22 + Lenovo IdeaPad 330sで LFM 2.5 を使ったローカルLLM入門

この記事では、**LFM 2.5** を使ってローカル環境でLLMを動かす最小構成の手順を紹介します。
対象環境は以下の通りです。

## 動作環境

* OS: Ubuntu 22.04 LTS

  * ※ ポータブルSSD（BUFFALO USB3.1 Gen1 240GB）にインストール
* PC: Lenovo IdeaPad 330s

  * CPU: Intel系（内蔵GPUのみ想定）
  * メモリ: 8GB前後を想定
* GPU: なし（CPU実行）

GPUなし・省メモリ環境でも「試せる」ことを重視します。

---

## 1. 事前準備

### システム更新

```bash
sudo apt update && sudo apt upgrade -y
```

### Python環境

Ubuntu 22.04 には Python 3.10 が入っているのでそれを使います。

```bash
python3 --version
```

venv を用意します。

```bash
sudo apt install -y python3-venv
python3 -m venv lfm-env
source lfm-env/bin/activate
```

---

## 2. 必要パッケージのインストール

### PyTorch（CPU版）

GPUがないため **CPU版** を入れます。

```bash
pip install --upgrade pip
pip install torch torchvision torchaudio --index-url https://download.pytorch.org/whl/cpu
```

確認：

```bash
python - << 'EOF'
import torch
print(torch.__version__)
print("CUDA available:", torch.cuda.is_available())
EOF
```

`False` ならOKです。

---

## 3. LFM 2.5 のインストール

LFM（Lightweight Foundation Model）は比較的軽量で、CPU環境でも試しやすいモデルです。

```bash
pip install lfm
```

※ バージョン確認：

```bash
pip show lfm
```

---

## 4. LFM 2.5 モデルのダウンロード

初回実行時に自動で落ちますが、明示的にロードしてみます。

```python
from lfm import LFM

model = LFM.from_pretrained("lfm-2.5")
```

IdeaPad 330s + USB SSD 環境では、**初回ロードに数分**かかることがあります。

---

## 5. 最小実行サンプル

CPU・省メモリ向けに、生成トークン数を小さくします。

```python
from lfm import LFM

model = LFM.from_pretrained(
    "lfm-2.5",
    device="cpu",
)

prompt = "UbuntuでローカルLLMを動かすメリットは？"

output = model.generate(
    prompt,
    max_new_tokens=64,
)

print(output)
```

### 実行

```bash
python run_lfm.py
```

---

## 6. 実行時のコツ（重要）

### メモリ節約

* `max_new_tokens` は **64〜128** 程度にする
* 他のアプリはできるだけ終了する

### USB SSD運用時の注意

* 発熱で速度低下する場合あり
* `/tmp` を SSD 上にしておくと安定することが多い

```bash
df -h
```

で空き容量を確認してください（最低でも10GB以上推奨）。

---

## 7. よくあるトラブル

### Q. 実行が極端に遅い

* CPU実行なので仕様です
* トークン数を減らしてください

### Q. メモリ不足で落ちる

* `max_new_tokens` を減らす
* 他プロセスを止める
* スワップ有効化も検討

```bash
sudo swapon --show
```

---

## 8. まとめ

* Lenovo IdeaPad 330s + Ubuntu 22 + USB SSD でも **LFM 2.5は動く**
* GPUなしでも「ローカルLLM体験」は十分可能
* 軽量モデルから始めるのが現実的

次のステップとしては：

* プロンプト調整
* バッチ実行
* 簡単なCLIツール化

などがおすすめです。
